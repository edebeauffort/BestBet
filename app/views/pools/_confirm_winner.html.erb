
<div class ="container">
  <div class ="wrapper">
    <div class="hiddeable">

    <% if current_user == @pool.user %>
      <label class="wrapper" for="selections">Declare the Winner
      </label>

      <form novalidate="novalidate" class="simple_form edit_pool" id="edit_pool_<%= @pool.id %>" action="/pools/<%= @pool.id %>/declare_winner" accept-charset="UTF-8" method="post">

        <div class="button dropdown">
          <select id="declarewinner" class="form-control select optional" name="pool[selection_id]" id="pool_selection_id">
            <option value="" disabled selected> Select the Winning Bet: </option>
            <%= @pool.selections.each do |selection| %>
            <option value="<%= selection.id %>"><%= selection.title %></option>
            <% end %>
          </select>
        </div>


        <div class ="confirm-button">
          <input type="submit" name="commit" value="Confirm" class="btn btn-primary selection-submit" data-disable-with="Confirm">
        </div>


        <input name="utf8" type="hidden" value="âœ“">
        <input type="hidden" name="authenticity_token" value="rzJWaLodhFTcxCw/JgIDOBy5egK1P9qAP8tS/cw8XnQqFfEMpqiLHnRXIVhNUpTWwCz1zD9YEEUZXgN/eDGzWA==">

      </form>
    </div>
    <% end %>

    <div class="container winner-output">
      <div class="output" id="winner">
        <% if @pool.selections.where(winning_selection: true).count > 0 %>
          <h3><%= @winner.title + " Wins!" %></h3>
        <% else %>
        <h3> No Winner Yet... </h3>
        <% end %>
        <% if current_user == @pool.user %>
        <div class = "edit-winner bottomright">
        <i class='fa fa-wrench' id="admin-change-winner"></i>
        </div>
        <% end %>
      </div>
    </div>

  </div>
</div>


<%= content_for(:after_js) do %>
<script>
  $(function() {
    // $('#declarewinner').change(function(){
    //   $('.selections').hide();
    //   $('#' + $(this).val()).show();
    // });
    if (<%= Time.now < @pool.end_date %>) {
      $('.hiddeable').show();
      $(".selection-submit").prop('disabled', true);
      document.getElementById("declarewinner").disabled = true;
    }
    $('.edit_pool').submit(function() {
     $('.hiddeable').hide()
   })
    $('#admin-change-winner').click(function() {
      $('.hiddeable').show();
    });
    var output = $('#winner').text().trim();
    if (output != "") {
      $('.hiddeable').hide();
    }
  });
</script>
<% end %>
